
# Set up

Import packages
```{r}
suppressPackageStartupMessages({
  suppressWarnings({
  library(tidyverse)   # Data wrangling
  library(here)        # File management
  library(readxl)      # Read excel files
  })})
```

Set settings and universal variables
```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = here())
```

# Import data

Load in cleaned & deduplicated network data
```{r}
network = read.csv("Data/Outputs/20251002_network_data_cleaned.csv")
```

# Project column

Clean up project column and split into 3 separate dummy variables for 1) SWP, 2) CVP, and 3) Colorado.
Override if source type is another PWS (ex: either ‘purchased’ or NA)

```{r}
project_cols = network%>%
  mutate(
    swp = case_when(
      Source_type == "PWS" ~ NA,
      grepl("SWP", Project) ~ 1,
      T ~ 0),
    cvp = case_when(
      Source_type == "PWS" ~ NA,
      grepl("CVP", Project) ~ 1,
      T ~ 0),
    colorado = case_when(
      Source_type == "PWS" ~ NA,
      grepl("Colorado|Coloardo", Project) ~ 1,
      T ~ 0))%>%
  select(PWSID, Source, swp, cvp, colorado)
```

# Export
```{r}
write.csv(project_cols, "Data/Outputs/20251002_project_columns.csv", row.names = F)
```



For later: 
Take another look at rows with project marked as >1, revise if needed
Validation with lists of SWP/CVP contractors

Take a look at column with project marked "Yes"

```{r}
network%>%
  filter(swp + cvp + colorado > 1)
```